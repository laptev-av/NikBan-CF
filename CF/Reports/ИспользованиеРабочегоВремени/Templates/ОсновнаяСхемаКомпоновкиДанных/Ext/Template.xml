<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИнформационнаяБаза</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Дата</dataPath>
			<field>Дата</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сотрудник</dataPath>
			<field>Сотрудник</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сотрудник</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
			<inputParameters>
				<dcscor:item>
					<dcscor:parameter>СвязиПараметровВыбора</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:ChoiceParameterLinks">
						<dcscor:item>
							<dcscor:choiceParameter>Отбор.Магазин</dcscor:choiceParameter>
							<dcscor:value>Магазин</dcscor:value>
							<dcscor:mode xmlns:d8p1="http://v8.1c.ru/8.1/data/enterprise" xsi:type="d8p1:LinkedValueChangeMode">Clear</dcscor:mode>
						</dcscor:item>
					</dcscor:value>
				</dcscor:item>
			</inputParameters>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового</dataPath>
			<field>ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отклонение факта по плану от плана (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыделятьОтрицательные</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтклонениеФактическиОтработанногоВремениОтПланового</dataPath>
			<field>ОтклонениеФактическиОтработанногоВремениОтПланового</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отклонение факта от плана (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыделятьОтрицательные</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтношениеВнеПланируемогоВремениКПлановому</dataPath>
			<field>ОтношениеВнеПланируемогоВремениКПлановому</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отношение факта вне плана к плану (%)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому</dataPath>
			<field>ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отношение факта по плану к плану (%)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтношениеФактическиОтработанногоВремениКПлановому</dataPath>
			<field>ОтношениеФактическиОтработанногоВремениКПлановому</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отношение факта к плану (%)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПланируемоеКоличествоЧасов</dataPath>
			<field>ПланируемоеКоличествоЧасов</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>План (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФактическоеКоличествоЧасов</dataPath>
			<field>ФактическоеКоличествоЧасов</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Факт (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ЦветФона</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">auto</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФактическоеКоличествоЧасовВнеПланируемогоВремени</dataPath>
			<field>ФактическоеКоличествоЧасовВнеПланируемогоВремени</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Факт вне плана (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыделятьОтрицательные</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФактическоеКоличествоЧасовВПланируемоеВремя</dataPath>
			<field>ФактическоеКоличествоЧасовВПланируемоеВремя</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Факт по плану (час)</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<group>true</group>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">ЧЦ=10; ЧДЦ=2; ЧРД=.; ЧРГ=' '</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыделятьОтрицательные</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МаксимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">8</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Магазин</dataPath>
			<field>Магазин</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Магазин</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФактическоеВПланируемое</dataPath>
			<field>ФактическоеВПланируемое</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Фактическое в планируемое</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Планируемое</dataPath>
			<field>Планируемое</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Планируемое</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Фактическое</dataPath>
			<field>Фактическое</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Фактическое</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Смена</dataPath>
			<field>Смена</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<dataSource>ИнформационнаяБаза</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПодЗапрос.Сотрудник КАК Сотрудник,
	ПодЗапрос.Дата КАК Дата,
	ПодЗапрос.Смена,
	МАКСИМУМ(ПодЗапрос.Период) КАК НачалоПлан,
	МАКСИМУМ(ПодЗапрос.ДатаОкончания) КАК КонецПлан,
	МАКСИМУМ(ПодЗапрос.НачалоРаботы) КАК НачалоФакт,
	МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы) КАК КонецФакт,
	СУММА(ПодЗапрос.Планируемое) КАК Планируемое,
	СУММА(ПодЗапрос.Фактическое) КАК Фактическое,
	ВЫБОР
		КОГДА МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы) МЕЖДУ МАКСИМУМ(ПодЗапрос.Период) И МАКСИМУМ(ПодЗапрос.ДатаОкончания)
				И МАКСИМУМ(ПодЗапрос.НачалоРаботы) &lt; МАКСИМУМ(ПодЗапрос.Период)
			ТОГДА РАЗНОСТЬДАТ(МАКСИМУМ(ПодЗапрос.Период), МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы), МИНУТА) / 60
		ИНАЧЕ ВЫБОР
				КОГДА МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы) МЕЖДУ МАКСИМУМ(ПодЗапрос.Период) И МАКСИМУМ(ПодЗапрос.ДатаОкончания)
						И МАКСИМУМ(ПодЗапрос.НачалоРаботы) &gt;= МАКСИМУМ(ПодЗапрос.Период)
					ТОГДА РАЗНОСТЬДАТ(МАКСИМУМ(ПодЗапрос.НачалоРаботы), МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы), МИНУТА) / 60
				ИНАЧЕ ВЫБОР
						КОГДА МАКСИМУМ(ПодЗапрос.ДатаОкончания) МЕЖДУ МАКСИМУМ(ПодЗапрос.НачалоРаботы) И МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы)
								И МАКСИМУМ(ПодЗапрос.Период) &lt; МАКСИМУМ(ПодЗапрос.НачалоРаботы)
							ТОГДА РАЗНОСТЬДАТ(МАКСИМУМ(ПодЗапрос.НачалоРаботы), МАКСИМУМ(ПодЗапрос.ДатаОкончания), МИНУТА) / 60
						ИНАЧЕ ВЫБОР
								КОГДА МАКСИМУМ(ПодЗапрос.ДатаОкончания) МЕЖДУ МАКСИМУМ(ПодЗапрос.НачалоРаботы) И МАКСИМУМ(ПодЗапрос.ОкончаниеРаботы)
										И МАКСИМУМ(ПодЗапрос.Период) &gt;= МАКСИМУМ(ПодЗапрос.НачалоРаботы)
									ТОГДА РАЗНОСТЬДАТ(МАКСИМУМ(ПодЗапрос.Период), МАКСИМУМ(ПодЗапрос.ДатаОкончания), МИНУТА) / 60
								ИНАЧЕ 0
							КОНЕЦ
					КОНЕЦ
			КОНЕЦ
	КОНЕЦ КАК ФактическоеВПланируемое
ПОМЕСТИТЬ Временная
ИЗ
	(ВЫБРАТЬ
		ПланируемоеВремя.Сотрудник КАК Сотрудник,
		НАЧАЛОПЕРИОДА(ПланируемоеВремя.Период, ДЕНЬ) КАК Дата,
		ПланируемоеВремя.Период КАК Период,
		ПланируемоеВремя.ДатаОкончания КАК ДатаОкончания,
		РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0), ПланируемоеВремя.ДлинаРабочегоВремени, МИНУТА) / 60 КАК Планируемое,
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК НачалоРаботы,
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ОкончаниеРаботы,
		0 КАК Фактическое,
		ПланируемоеВремя.ИнтервалРаботыМагазинов КАК Смена
	ИЗ
		РегистрСведений.ПланируемоеРабочееВремяСотрудников КАК ПланируемоеВремя
	ГДЕ
		ПланируемоеВремя.Период &gt;= &amp;НачалоПериода
		И (ПланируемоеВремя.Период &lt;= &amp;КонецПериода
				ИЛИ &amp;КонецПериода = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0))
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ФактическоеРабочееВремяСотрудников.Сотрудник,
		НАЧАЛОПЕРИОДА(ФактическоеРабочееВремяСотрудников.НачалоРаботы, ДЕНЬ),
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
		0,
		ФактическоеРабочееВремяСотрудников.НачалоРаботы,
		ФактическоеРабочееВремяСотрудников.ОкончаниеРаботы,
		ФактическоеРабочееВремяСотрудников.РабочееВремяСотрудников,
		ФактическоеРабочееВремяСотрудников.Смена
	ИЗ
		(ВЫБРАТЬ
			НАЧАЛОПЕРИОДА(ФактическоеРабочееВремяСотрудников.Период, ДЕНЬ) КАК Дата,
			ФактическоеРабочееВремяСотрудников.Сотрудник КАК Сотрудник,
			СУММА(ФактическоеРабочееВремяСотрудников.РабочееВремяСотрудников) КАК РабочееВремяСотрудников,
			МИНИМУМ(ФактическоеРабочееВремяСотрудников.НачалоРаботы) КАК НачалоРаботы,
			МАКСИМУМ(ФактическоеРабочееВремяСотрудников.ОкончаниеРаботы) КАК ОкончаниеРаботы,
			ФактическоеРабочееВремяСотрудников.Смена КАК Смена
		ИЗ
			РегистрНакопления.ФактическоеРабочееВремяСотрудников КАК ФактическоеРабочееВремяСотрудников
		ГДЕ
			ФактическоеРабочееВремяСотрудников.Период &gt;= &amp;НачалоПериода
			И (ФактическоеРабочееВремяСотрудников.Период &lt;= &amp;КонецПериода
					ИЛИ &amp;КонецПериода = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0))
		
		СГРУППИРОВАТЬ ПО
			ФактическоеРабочееВремяСотрудников.Сотрудник,
			НАЧАЛОПЕРИОДА(ФактическоеРабочееВремяСотрудников.Период, ДЕНЬ),
			ФактическоеРабочееВремяСотрудников.Смена) КАК ФактическоеРабочееВремяСотрудников) КАК ПодЗапрос

СГРУППИРОВАТЬ ПО
	ПодЗапрос.Сотрудник,
	ПодЗапрос.Дата,
	ПодЗапрос.Смена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СотрудникДата.Сотрудник.Магазин КАК Магазин,
	СотрудникДата.Сотрудник,
	СотрудникДата.Дата КАК Дата,
	ПланВФакт.Смена,
	ПланСотрудника.Планируемое КАК ПланируемоеКоличествоЧасов,
	ФактСотрудника.Фактическое КАК ФактическоеКоличествоЧасов,
	ПланВФакт.ФактическоеВПланируемое КАК ФактическоеКоличествоЧасовВПланируемоеВремя,
	ФактСотрудника.Фактическое - ПланВФакт.ФактическоеВПланируемое КАК ФактическоеКоличествоЧасовВнеПланируемогоВремени,
	ВЫБОР
		КОГДА ЕСТЬNULL(ПланСотрудника.Планируемое, 0) = 0
			ТОГДА 0
		ИНАЧЕ (ФактСотрудника.Фактическое - ПланВФакт.ФактическоеВПланируемое) / ПланСотрудника.Планируемое * 100
	КОНЕЦ КАК ОтношениеВнеПланируемогоВремениКПлановому,
	ФактСотрудника.Фактическое - ПланСотрудника.Планируемое КАК ОтклонениеФактическиОтработанногоВремениОтПланового,
	ВЫБОР
		КОГДА ЕСТЬNULL(ПланСотрудника.Планируемое, 0) = 0
			ТОГДА 0
		ИНАЧЕ ФактСотрудника.Фактическое / ПланСотрудника.Планируемое * 100
	КОНЕЦ КАК ОтношениеФактическиОтработанногоВремениКПлановому,
	ПланВФакт.ФактическоеВПланируемое - ПланСотрудника.Планируемое КАК ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового,
	ВЫБОР
		КОГДА ЕСТЬNULL(ПланСотрудника.Планируемое, 0) = 0
			ТОГДА 0
		ИНАЧЕ ПланВФакт.ФактическоеВПланируемое / ПланСотрудника.Планируемое * 100
	КОНЕЦ КАК ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому
ИЗ
	(ВЫБРАТЬ
		Временная.Сотрудник КАК Сотрудник,
		Временная.Дата КАК Дата,
		Временная.Смена КАК Смена
	ИЗ
		Временная КАК Временная
	
	СГРУППИРОВАТЬ ПО
		Временная.Сотрудник,
		Временная.Дата,
		Временная.Смена) КАК СотрудникДата
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			СУММА(ЕСТЬNULL(План.Планируемое, 0)) КАК Планируемое,
			План.Сотрудник КАК Сотрудник,
			План.Дата КАК Дата,
			План.Смена КАК Смена
		ИЗ
			(ВЫБРАТЬ
				Временная.Сотрудник КАК Сотрудник,
				Временная.Дата КАК Дата,
				МАКСИМУМ(Временная.Планируемое) КАК Планируемое,
				Временная.Смена КАК Смена
			ИЗ
				Временная КАК Временная
			
			СГРУППИРОВАТЬ ПО
				Временная.Сотрудник,
				Временная.Дата,
				Временная.НачалоПлан,
				Временная.КонецПлан,
				Временная.Смена) КАК План
		
		СГРУППИРОВАТЬ ПО
			План.Сотрудник,
			План.Дата,
			План.Смена) КАК ПланСотрудника
		ПО СотрудникДата.Сотрудник = ПланСотрудника.Сотрудник
			И СотрудникДата.Дата = ПланСотрудника.Дата
			И СотрудникДата.Смена = ПланСотрудника.Смена
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			СУММА(ЕСТЬNULL(Факт.Фактическое, 0)) КАК Фактическое,
			Факт.Сотрудник КАК Сотрудник,
			Факт.Дата КАК Дата,
			Факт.Смена КАК Смена
		ИЗ
			(ВЫБРАТЬ
				Временная.Сотрудник КАК Сотрудник,
				Временная.Дата КАК Дата,
				Временная.Смена КАК Смена,
				МАКСИМУМ(Временная.Фактическое) КАК Фактическое
			ИЗ
				Временная КАК Временная
			
			СГРУППИРОВАТЬ ПО
				Временная.Сотрудник,
				Временная.Дата,
				Временная.НачалоФакт,
				Временная.КонецФакт,
				Временная.Смена) КАК Факт
		
		СГРУППИРОВАТЬ ПО
			Факт.Сотрудник,
			Факт.Дата,
			Факт.Смена) КАК ФактСотрудника
		ПО СотрудникДата.Сотрудник = ФактСотрудника.Сотрудник
			И СотрудникДата.Дата = ФактСотрудника.Дата
			И СотрудникДата.Смена = ФактСотрудника.Смена
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Временная.Сотрудник КАК Сотрудник,
			Временная.Дата КАК Дата,
			Временная.Смена КАК Смена,
			СУММА(ЕСТЬNULL(Временная.ФактическоеВПланируемое, 0)) КАК ФактическоеВПланируемое
		ИЗ
			Временная КАК Временная
		
		СГРУППИРОВАТЬ ПО
			Временная.Сотрудник,
			Временная.Дата,
			Временная.Смена) КАК ПланВФакт
		ПО СотрудникДата.Сотрудник = ПланВФакт.Сотрудник
			И СотрудникДата.Дата = ПланВФакт.Дата
			И СотрудникДата.Смена = ПланВФакт.Смена</query>
	</dataSet>
	<totalField>
		<dataPath>ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового</dataPath>
		<expression>Сумма(ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового)</expression>
	</totalField>
	<totalField>
		<dataPath>ОтклонениеФактическиОтработанногоВремениОтПланового</dataPath>
		<expression>Сумма(ОтклонениеФактическиОтработанногоВремениОтПланового)</expression>
	</totalField>
	<totalField>
		<dataPath>ОтношениеВнеПланируемогоВремениКПлановому</dataPath>
		<expression>Среднее(ОтношениеВнеПланируемогоВремениКПлановому)</expression>
	</totalField>
	<totalField>
		<dataPath>ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому</dataPath>
		<expression>Среднее(ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому)</expression>
	</totalField>
	<totalField>
		<dataPath>ОтношениеФактическиОтработанногоВремениКПлановому</dataPath>
		<expression>Среднее(ОтношениеФактическиОтработанногоВремениКПлановому)</expression>
	</totalField>
	<totalField>
		<dataPath>ПланируемоеКоличествоЧасов</dataPath>
		<expression>Сумма(ПланируемоеКоличествоЧасов)</expression>
	</totalField>
	<totalField>
		<dataPath>ФактическоеКоличествоЧасов</dataPath>
		<expression>Сумма(ФактическоеКоличествоЧасов)</expression>
	</totalField>
	<totalField>
		<dataPath>ФактическоеКоличествоЧасовВнеПланируемогоВремени</dataPath>
		<expression>Сумма(ФактическоеКоличествоЧасовВнеПланируемогоВремени)</expression>
	</totalField>
	<totalField>
		<dataPath>ФактическоеКоличествоЧасовВПланируемоеВремя</dataPath>
		<expression>Сумма(ФактическоеКоличествоЧасовВПланируемоеВремя)</expression>
	</totalField>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаОкончания</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаНачала</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>v8:StandardPeriod</v8:Type>
		</valueType>
		<value xsi:type="v8:StandardPeriod">
			<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
			<v8:startDate>0001-01-01T00:00:00</v8:startDate>
			<v8:endDate>0001-01-01T00:00:00</v8:endDate>
		</value>
		<useRestriction>false</useRestriction>
		<inputParameters>
			<dcscor:item>
				<dcscor:use>false</dcscor:use>
				<dcscor:parameter>БыстрыйВыбор</dcscor:parameter>
				<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
			</dcscor:item>
		</inputParameters>
	</parameter>
	<settingsVariant>
		<dcsset:name>РабочееВремяСотрудников</dcsset:name>
		<dcsset:presentation xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Рабочее время сотрудников</v8:content>
			</v8:item>
		</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ПланируемоеКоличествоЧасов</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ФактическоеКоличествоЧасов</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ФактическоеКоличествоЧасовВПланируемоеВремя</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ФактическоеКоличествоЧасовВнеПланируемогоВремени</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтношениеВнеПланируемогоВремениКПлановому</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтклонениеФактическиОтработанногоВремениОтПланового</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтношениеФактическиОтработанногоВремениКПлановому</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтклонениеФактическиОтработанногоВремениВПланируемоеВремяОтПланового</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:filter>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Магазин</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="xs:string">00000000-0000-0000-0000-000000000000</dcsset:right>
					<dcsset:userSettingID>0ec72a1c-3102-4e0b-a8bf-4b49cfbf17e8</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Сотрудник</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="xs:string">00000000-0000-0000-0000-000000000000</dcsset:right>
					<dcsset:userSettingID>2c6dd36b-357d-4f8c-8a6f-a736defffec2</dcsset:userSettingID>
				</dcsset:item>
			</dcsset:filter>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Период</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardPeriod">
						<v8:variant xsi:type="v8:StandardPeriodVariant">ThisMonth</v8:variant>
					</dcscor:value>
					<dcsset:userSettingID>62ddee7c-ecbf-490d-9cf1-87291c27cee6</dcsset:userSettingID>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:conditionalAppearance>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>ПланируемоеКоличествоЧасов</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Дата</dcsset:left>
							<dcsset:comparisonType>Filled</dcsset:comparisonType>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветФона</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:FieldAlternativeBackColor</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
				</dcsset:item>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>ОтношениеФактическиОтработанногоВремениВПланируемоеВремяКПлановому</dcsset:field>
						</dcsset:item>
						<dcsset:item>
							<dcsset:field>ОтношениеФактическиОтработанногоВремениКПлановому</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Дата</dcsset:left>
							<dcsset:comparisonType>Filled</dcsset:comparisonType>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветФона</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">web:AliceBlue</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
				</dcsset:item>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>Смена</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Смена</dcsset:left>
							<dcsset:comparisonType>NotFilled</dcsset:comparisonType>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветТекста</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:ЦветНедоступногоТекста</dcscor:value>
						</dcscor:item>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>Текст</dcscor:parameter>
							<dcscor:value xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>&lt;Смена не указана&gt;</v8:content>
								</v8:item>
							</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
				</dcsset:item>
			</dcsset:conditionalAppearance>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>МакетОформления</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">Sea</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Рабочее время сотрудников</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьПараметрыДанных</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВыводитьОтбор</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionTextOutputType">DontOutput</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemTable">
				<dcsset:row>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Магазин</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
					<dcsset:item>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Дата</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
						</dcsset:selection>
						<dcsset:item>
							<dcsset:groupItems>
								<dcsset:item xsi:type="dcsset:GroupItemField">
									<dcsset:field>Смена</dcsset:field>
									<dcsset:groupType>Items</dcsset:groupType>
									<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
									<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
									<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
								</dcsset:item>
							</dcsset:groupItems>
							<dcsset:order>
								<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
							</dcsset:order>
							<dcsset:selection>
								<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
							</dcsset:selection>
							<dcsset:item>
								<dcsset:groupItems>
									<dcsset:item xsi:type="dcsset:GroupItemField">
										<dcsset:field>Сотрудник</dcsset:field>
										<dcsset:groupType>Items</dcsset:groupType>
										<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
										<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
										<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
									</dcsset:item>
								</dcsset:groupItems>
								<dcsset:order>
									<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
								</dcsset:order>
								<dcsset:selection>
									<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
								</dcsset:selection>
							</dcsset:item>
						</dcsset:item>
					</dcsset:item>
				</dcsset:row>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>