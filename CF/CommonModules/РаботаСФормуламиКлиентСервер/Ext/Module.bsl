#Область ПрограммныйИнтерфейс

// Функция преобразует операнд в строку для вставки в формулу.
//
Функция ПолучитьТекстОперандаДляВставки(Операнд) Экспорт
	
	Возврат "[" + Операнд + "]";
	
КонецФункции // ПолучитьТекстОперандаДляВставки()

// Функция выполняет проверку формулы.
//
Функция ПроверитьФормулу(Формула, Операнды, Знач Поле = "", Знач СообщениеОбОшибке = "") Экспорт
	
	Результат = Истина;
	
	ТекстРасчета = Формула;
	Если ЗначениеЗаполнено(ТекстРасчета) Тогда
		
		Для Каждого Операнд Из Операнды Цикл
			ТекстРасчета = СтрЗаменить(ТекстРасчета, ПолучитьТекстОперандаДляВставки(Операнд), " 1 ");
		КонецЦикла;
		
		Попытка
			
		#Если ВебКлиент Тогда
			РезультатРасчета = РаботаСФормуламиВызовСервера.ВычислитьФормулу(ТекстРасчета);
		#Иначе
			РезультатРасчета = Вычислить(ТекстРасчета);
		#КонецЕсли
			
		Исключение
		
			Результат = Ложь;
			
			ТекстСообщения = НСтр("ru='В формуле обнаружены ошибки'");
			
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения, , "Формула");
			
		КонецПопытки;
		
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции // ПроверитьФормулу()

#КонецОбласти
