<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанныхЗапрос</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Количество</dataPath>
			<field>Количество</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.НомерСтроки</dataPath>
			<field>НомерСтроки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер строки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Склад</dataPath>
			<field>Склад</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Склад</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>Товары</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Реквизиты табличных частей</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>Скидки</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Скидки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldFolder">
			<dataPath>Товары.Номенклатура</dataPath>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номенклатура</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.НоменклатураСсылка</dataPath>
			<field>НоменклатураСсылка</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дополнительное описание</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Артикул</dataPath>
			<field>Артикул</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Артикул</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Весовой</dataPath>
			<field>Весовой</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Весовой</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ВидНоменклатуры</dataPath>
			<field>ВидНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Код</dataPath>
			<field>Код</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Родитель</dataPath>
			<field>Родитель</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Родитель</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ТоварнаяГруппа</dataPath>
			<field>ТоварнаяГруппа</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Товарная группа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.СтранаПроисхождения</dataPath>
			<field>СтранаПроисхождения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна происхождения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Штрихкод</dataPath>
			<field>Штрихкод</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Штрихкод</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Сумма</dataPath>
			<field>Сумма</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.ЦенаБезСкидки</dataPath>
			<field>ЦенаБезСкидки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Цена</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.СкидкаНаценка</dataPath>
			<field>СкидкаНаценка</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Скидка наценка</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ДоговорПлатежногоАгента</dataPath>
			<field>ДоговорПлатежногоАгента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Договор платежного агента</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ПосредникУслуг</dataPath>
			<field>ПосредникУслуг</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Посредник услуг</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.Агент</dataPath>
			<field>Агент</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Поставщик услуг</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.ПроцентКомиссионногоВознаграждения</dataPath>
			<field>ПроцентКомиссионногоВознаграждения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Процент комиссионного вознаграждения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.СуммаБезКомиссии</dataPath>
			<field>СуммаБезКомиссии</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма без комиссии</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.СуммаКомиссионногоВознаграждения</dataPath>
			<field>СуммаКомиссионногоВознаграждения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма комиссионного вознаграждения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ТелефонПосредникаУслуг</dataPath>
			<field>ТелефонПосредникаУслуг</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Телефон посредника услуг</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Товары.Номенклатура.ТелефонПоставщикаУслуг</dataPath>
			<field>ТелефонПоставщикаУслуг</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Телефон поставщика услуг</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Подарки.НомерСтроки КАК НомерСтроки,
	Подарки.Номенклатура КАК НоменклатураСсылка,
	Подарки.Номенклатура.Код КАК Код,
	Подарки.Номенклатура.Родитель КАК Родитель,
	Подарки.Номенклатура.Наименование КАК Наименование,
	Подарки.Номенклатура.Артикул КАК Артикул,
	Подарки.Номенклатура.Весовой КАК Весовой,
	Подарки.Номенклатура.ВидНоменклатуры КАК ВидНоменклатуры,
	ВЫБОР	КОГДА Подарки.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА Подарки.Номенклатура.ЕдиницаИзмерения
			ИНАЧЕ Подарки.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	Подарки.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Подарки.Номенклатура.ТоварнаяГруппа КАК ТоварнаяГруппа,
	Подарки.Номенклатура.СтранаПроисхождения КАК СтранаПроисхождения,
	Подарки.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР	КОГДА Подарки.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА Подарки.Количество
			ИНАЧЕ Подарки.КоличествоУпаковок
	КОНЕЦ КАК Количество,
	Подарки.Номенклатура.ДоговорПлатежногоАгента КАК ДоговорПлатежногоАгента,
	Подарки.Номенклатура.ДоговорПлатежногоАгента.Агент КАК Агент,
	ВЫРАЗИТЬ(КонтактнаяИнформацияПоставщиковУслуг.Представление КАК СТРОКА(255)) КАК ТелефонПоставщикаУслуг,
	Подарки.Номенклатура.ДоговорПлатежногоАгента.Посредник КАК ПосредникУслуг,
	ВЫРАЗИТЬ(КонтактнаяИнформацияПосредниковУслуг.Представление КАК СТРОКА(255)) КАК ТелефонПосредникаУслуг,
	ЕСТЬNULL(Подарки.Номенклатура.ДоговорПлатежногоАгента.ПроцентКомиссионногоВознаграждения, 0) КАК ПроцентКомиссионногоВознаграждения,
	Подарки.Сумма * ЕСТЬNULL(Подарки.Номенклатура.ДоговорПлатежногоАгента.ПроцентКомиссионногоВознаграждения, 0) / 100 КАК СуммаКомиссионногоВознаграждения,
	ВЫБОР
		КОГДА ЕСТЬNULL(Подарки.Номенклатура.ДоговорПлатежногоАгента.ПроцентКомиссионногоВознаграждения, 0) &lt;&gt; 0
			ТОГДА Подарки.Сумма - Подарки.Сумма * ЕСТЬNULL(Подарки.Номенклатура.ДоговорПлатежногоАгента.ПроцентКомиссионногоВознаграждения, 0) / 100
		ИНАЧЕ 0
	КОНЕЦ КАК СуммаБезКомиссии,
	
	Штрихкоды.Штрихкод КАК Штрихкод,
	Подарки.Склад КАК Склад,
	Подарки.СкидкаНаценка.Наименование КАК СкидкаНаценка,
	Подарки.Цена КАК ЦенаБезСкидки,
	Подарки.Сумма КАК Сумма

ИЗ
	Документ.ЧекККМ.Подарки КАК Подарки
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫРАЗИТЬ(Штрихкоды.Владелец КАК Справочник.Номенклатура) КАК Номенклатура,
			Штрихкоды.Упаковка КАК ЕдиницаИзмерения,
			Штрихкоды.Характеристика КАК ХарактеристикаНоменклатуры,
			МАКСИМУМ(Штрихкоды.Штрихкод) КАК Штрихкод
		ИЗ
			РегистрСведений.Штрихкоды КАК Штрихкоды
		
		СГРУППИРОВАТЬ ПО
			ВЫРАЗИТЬ(Штрихкоды.Владелец КАК Справочник.Номенклатура),
			Штрихкоды.Упаковка,
			Штрихкоды.Характеристика) КАК Штрихкоды
		ПО Подарки.Номенклатура = Штрихкоды.Номенклатура
			И Подарки.Характеристика = Штрихкоды.ХарактеристикаНоменклатуры
		// Телефоны поставщиков услуг 
		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Контрагенты.КонтактнаяИнформация КАК КонтактнаяИнформацияПоставщиковУслуг
		ПО Подарки.Номенклатура.ДоговорПлатежногоАгента.Агент = КонтактнаяИнформацияПоставщиковУслуг.Ссылка
		И КонтактнаяИнформацияПоставщиковУслуг.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКОнтактнойИнформации.Телефон)
		И КонтактнаяИнформацияПоставщиковУслуг.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.ТелефонКонтрагента)}
		// Телефоны посредников услуг 
		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Контрагенты.КонтактнаяИнформация КАК КонтактнаяИнформацияПосредниковУслуг
		ПО Подарки.Номенклатура.ДоговорПлатежногоАгента.Посредник = КонтактнаяИнформацияПосредниковУслуг.Ссылка
		И КонтактнаяИнформацияПосредниковУслуг.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКОнтактнойИнформации.Телефон)
		И КонтактнаяИнформацияПосредниковУслуг.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.ТелефонКонтрагента)}
</query>
	</dataSet>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>